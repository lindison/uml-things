@startuml
title Traffic Shift

kubectl -> traffic_shift: kubectl traffic shift
traffic_shift -> frontendv2: create frontendv2
frontendv2 -> updated_pods: deploy pods
new_pods -> label_query: reroute traffic
new_pods ->o kubectl: successful update
group rollback
  kubectl -> label_query: initiate rollback
  label_query -> frontendv1: route trafic to legacy
  frontendv1 -> legacy_pods: traffic routed
  legacy_pods -> kubectl: rollback complete
end

box "update rc and pods" #b4f985
  participant frontendv2
  participant updated_pods
end box

box "legacy rc and pods" #adb1f4
  participant frontendv1
  participant legacy_pods
end box

@enduml
